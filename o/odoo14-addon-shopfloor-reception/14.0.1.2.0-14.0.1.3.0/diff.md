# Comparing `tmp/odoo14_addon_shopfloor_reception-14.0.1.2.0-py3-none-any.whl.zip` & `tmp/odoo14_addon_shopfloor_reception-14.0.1.3.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,35 +1,35 @@
-Zip file size: 177211 bytes, number of entries: 33
--rw-r--r--  2.0 unx     3384 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/README.rst
--rw-r--r--  2.0 unx       23 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/__init__.py
--rw-r--r--  2.0 unx      587 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/__manifest__.py
--rw-r--r--  2.0 unx      412 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/data/shopfloor_scenario_data.xml
--rw-r--r--  2.0 unx      627 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/demo/shopfloor_menu_demo.xml
--rw-r--r--  2.0 unx      965 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/demo/stock_picking_type_demo.xml
--rw-r--r--  2.0 unx     3866 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/docs/reception_sequence_graph.mermaid
--rw-r--r--  2.0 unx   155103 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/docs/reception_sequence_graph.png
--rw-r--r--  2.0 unx      658 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/i18n/shopfloor_reception.pot
--rw-r--r--  2.0 unx      216 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      131 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      109 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/readme/ROADMAP.rst
--rw-r--r--  2.0 unx       24 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/services/__init__.py
--rw-r--r--  2.0 unx    57237 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/services/reception.py
--rw-r--r--  2.0 unx     9455 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/static/description/icon.png
--rw-r--r--  2.0 unx    12973 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/static/description/index.html
--rw-r--r--  2.0 unx      368 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/__init__.py
--rw-r--r--  2.0 unx     4729 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/common.py
--rw-r--r--  2.0 unx     1253 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_manual_selection.py
--rw-r--r--  2.0 unx     3450 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_reception_done.py
--rw-r--r--  2.0 unx     4836 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_select_dest_package.py
--rw-r--r--  2.0 unx     8223 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_select_document.py
--rw-r--r--  2.0 unx    10654 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_select_move.py
--rw-r--r--  2.0 unx     6804 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_set_destination.py
--rw-r--r--  2.0 unx     5574 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_set_lot.py
--rw-r--r--  2.0 unx     2219 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_set_lot_confirm.py
--rw-r--r--  2.0 unx    14216 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_set_quantity.py
--rw-r--r--  2.0 unx     2914 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_set_quantity_action.py
--rw-r--r--  2.0 unx     1699 b- defN 23-May-22 11:10 odoo/addons/shopfloor_reception/tests/test_start.py
--rw-r--r--  2.0 unx     4006 b- defN 23-May-22 11:11 odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-22 11:11 odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-May-22 11:11 odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3711 b- defN 23-May-22 11:11 odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/RECORD
-33 files, 320523 bytes uncompressed, 170889 bytes compressed:  46.7%
+Zip file size: 176986 bytes, number of entries: 33
+-rw-r--r--  2.0 unx     3384 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/README.rst
+-rw-r--r--  2.0 unx       23 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/__init__.py
+-rw-r--r--  2.0 unx      587 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/__manifest__.py
+-rw-r--r--  2.0 unx      412 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/data/shopfloor_scenario_data.xml
+-rw-r--r--  2.0 unx      627 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/demo/shopfloor_menu_demo.xml
+-rw-r--r--  2.0 unx      965 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/demo/stock_picking_type_demo.xml
+-rw-r--r--  2.0 unx     3866 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/docs/reception_sequence_graph.mermaid
+-rw-r--r--  2.0 unx   155103 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/docs/reception_sequence_graph.png
+-rw-r--r--  2.0 unx      658 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/i18n/shopfloor_reception.pot
+-rw-r--r--  2.0 unx      216 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      131 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      109 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx       24 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/services/__init__.py
+-rw-r--r--  2.0 unx    58269 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/services/reception.py
+-rw-r--r--  2.0 unx     9455 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/static/description/icon.png
+-rw-r--r--  2.0 unx    12973 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/static/description/index.html
+-rw-r--r--  2.0 unx      368 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/__init__.py
+-rw-r--r--  2.0 unx     4729 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/common.py
+-rw-r--r--  2.0 unx     1253 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_manual_selection.py
+-rw-r--r--  2.0 unx     3450 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_reception_done.py
+-rw-r--r--  2.0 unx     4836 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_select_dest_package.py
+-rw-r--r--  2.0 unx     6098 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_select_document.py
+-rw-r--r--  2.0 unx    10798 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_select_move.py
+-rw-r--r--  2.0 unx     6279 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_set_destination.py
+-rw-r--r--  2.0 unx     5574 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_set_lot.py
+-rw-r--r--  2.0 unx     2267 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_set_lot_confirm.py
+-rw-r--r--  2.0 unx    14254 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_set_quantity.py
+-rw-r--r--  2.0 unx     2914 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_set_quantity_action.py
+-rw-r--r--  2.0 unx     1699 b- defN 23-May-29 09:11 odoo/addons/shopfloor_reception/tests/test_start.py
+-rw-r--r--  2.0 unx     4006 b- defN 23-May-29 09:11 odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-29 09:11 odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-May-29 09:11 odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3711 b- defN 23-May-29 09:11 odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/RECORD
+33 files, 319135 bytes uncompressed, 170664 bytes compressed:  46.5%
```

## zipnote {}

```diff
@@ -81,20 +81,20 @@
 
 Filename: odoo/addons/shopfloor_reception/tests/test_set_quantity_action.py
 Comment: 
 
 Filename: odoo/addons/shopfloor_reception/tests/test_start.py
 Comment: 
 
-Filename: odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/METADATA
+Filename: odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/WHEEL
+Filename: odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/top_level.txt
+Filename: odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/RECORD
+Filename: odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/shopfloor_reception/__manifest__.py

```diff
@@ -1,11 +1,11 @@
 {
     "name": "Shopfloor Reception",
     "summary": "Reception scenario for shopfloor",
-    "version": "14.0.1.2.0",
+    "version": "14.0.1.3.0",
     "development_status": "Beta",
     "category": "Inventory",
     "website": "https://github.com/OCA/wms",
     "author": "Camptocamp, Odoo Community Association (OCA)",
     "maintainers": ["mmequignon", "JuMiSanAr"],
     "license": "AGPL-3",
     "installable": True,
```

## odoo/addons/shopfloor_reception/services/reception.py

```diff
@@ -147,15 +147,15 @@
             "new_package_name": new_package_name,
         }
         return self._response(
             next_state="confirm_new_package", data=data, message=message
         )
 
     def _select_document_from_move_lines(self, move_lines, msg_func):
-        pickings = move_lines.mapped("move_id.picking_id")
+        pickings = move_lines.move_id.picking_id
         if len(pickings) == 1:
             self._assign_user_to_picking(pickings)
             if (
                 move_lines.product_id.tracking not in ("lot", "serial")
                 or move_lines.lot_id
                 or move_lines.lot_name
             ):
@@ -176,45 +176,54 @@
         next states:
             - set_lot: a single picking has been found for this packaging
             - select_document: A single or no pickings has been found for this packaging
         """
         move_lines = self._move_line_by_product(product).filtered(
             lambda l: l.picking_id.picking_type_id.id in self.picking_types.ids
         )
-        return self._select_document_from_move_lines(
-            move_lines, self.msg_store.product_not_found_in_pickings
-        )
+        pickings = move_lines.move_id.picking_id
+        if pickings:
+            return self._response_for_select_document(
+                pickings=pickings,
+                message=self.msg_store.multiple_picks_found_select_manually(),
+            )
 
     def _select_document_from_packaging(self, packaging):
         """Select the document by packaging
 
         next states:
             - set_lot: a single picking has been found for this packaging
             - select_document: A single or no pickings has been found for this packaging
         """
         move_lines = self._move_line_by_packaging(packaging).filtered(
             lambda l: l.picking_id.picking_type_id.id in self.picking_types.ids
         )
-        return self._select_document_from_move_lines(
-            move_lines, self.msg_store.no_transfer_for_packaging
-        )
+        pickings = move_lines.move_id.picking_id
+        if pickings:
+            return self._response_for_select_document(
+                pickings=pickings,
+                message=self.msg_store.multiple_picks_found_select_manually(),
+            )
 
     def _select_document_from_lot(self, lot):
         """Select the document by lot
 
         next states:
             - set_lot: a single picking has been found for this packaging
             - select_document: A single or no pickings has been found for this packaging
         """
         move_lines = self._move_line_by_lot(lot)
         if not move_lines:
             return
-        return self._select_document_from_move_lines(
-            move_lines, self.msg_store.no_transfer_for_lot
-        )
+        pickings = move_lines.move_id.picking_id
+        if pickings:
+            return self._response_for_select_document(
+                pickings=pickings,
+                message=self.msg_store.multiple_picks_found_select_manually(),
+            )
 
     def _select_line(self, picking, line, move, increase_qty_done_by=1):
         product = line.product_id
         if line:
             # The line quantity to do needs to correspond to
             # the remaining quantity to do of its move.
             line.product_uom_qty = move.product_uom_qty - move.quantity_done
@@ -290,14 +299,15 @@
             today_start, today_end = self._get_today_start_end_datetime()
             picking_filter_result_due_today = picking_filter_result.filtered(
                 lambda p: today_start
                 <= p.scheduled_date.astimezone(pytz.utc)
                 < today_end
             )
             if len(picking_filter_result_due_today) == 1:
+                self._assign_user_to_picking(picking_filter_result_due_today)
                 return self._select_picking(picking_filter_result_due_today)
             if len(picking_filter_result) > 1:
                 return self._response_for_select_document(
                     pickings=reception_pickings,
                     message=self.msg_store.source_document_multiple_pickings_scan_package(),
                 )
             return self._select_picking(reception_pickings)
@@ -460,15 +470,15 @@
                 # set both package and destination on the package,
                 # and go back to the selection line screen
                 selected_line.result_package_id = package
                 selected_line.location_dest_id = pack_location
                 if self.work.menu.auto_post_line:
                     # If option auto_post_line is active in the shopfloor menu,
                     # create a split order with this line.
-                    self._auto_post_line(selected_line, picking)
+                    self._auto_post_line(selected_line)
                 return self._response_for_select_move(picking)
             # Scanned package has no location, move to the location selection
             # screen
             selected_line.result_package_id = package
             return self._response_for_set_destination(picking, selected_line)
 
     def _set_quantity__by_location(self, picking, selected_line, barcode):
@@ -497,19 +507,19 @@
     def _check_location_ok(self, location, selected_line, picking):
         if location.usage == "view":
             return (False, False)
 
         move_dest_location = selected_line.location_dest_id
         pick_type_dest_location = picking.picking_type_id.default_location_dest_id
 
-        move_dest_location_ok = move_dest_location.parent_path.startswith(
-            location.parent_path
+        move_dest_location_ok = location.parent_path.startswith(
+            move_dest_location.parent_path
         )
-        pick_type_dest_location_ok = pick_type_dest_location.parent_path.startswith(
-            location.parent_path
+        pick_type_dest_location_ok = location.parent_path.startswith(
+            pick_type_dest_location.parent_path
         )
         if move_dest_location_ok or pick_type_dest_location_ok:
             return (move_dest_location_ok, pick_type_dest_location_ok)
 
         return (False, False)
 
     def _use_handlers(self, handlers, *args, **kwargs):
@@ -576,20 +586,23 @@
             data={
                 "selected_move_line": self._data_for_move_lines(line),
                 "picking": self.data.picking(picking),
             },
             message=message,
         )
 
-    def _response_for_set_quantity(self, picking, line, message=None):
+    def _response_for_set_quantity(
+        self, picking, line, message=None, asking_confirmation=False
+    ):
         return self._response(
             next_state="set_quantity",
             data={
                 "selected_move_line": self._data_for_move_lines(line),
                 "picking": self.data.picking(picking),
+                "confirmation_required": asking_confirmation,
             },
             message=message,
         )
 
     def _response_for_set_destination(self, picking, line, message=None):
         return self._response(
             next_state="set_destination",
@@ -870,21 +883,23 @@
                 self._set_quantity__by_location,
                 self._set_quantity__by_lot,
             )
             response = self._use_handlers(handlers, picking, selected_line, barcode)
             if response:
                 return response
             # Nothing found, ask user if we should create a new pack for the scanned
-            # barcode
+            # barcode.
             if not confirmation:
                 return self._response_for_set_quantity(
                     picking,
                     selected_line,
                     message=self.msg_store.create_new_pack_ask_confirmation(barcode),
+                    asking_confirmation=True,
                 )
+            # Nothing found and we already ask for confirmation, create the new package.
             package = self.env["stock.quant.package"].create({"name": barcode})
             quantity = selected_line.qty_done
             __, qty_check = selected_line._split_qty_to_be_done(
                 quantity,
                 lot_id=False,
                 shopfloor_user_id=False,
                 expiration_date=False,
@@ -894,14 +909,18 @@
                     picking,
                     selected_line,
                     message=self.msg_store.unable_to_pick_more(
                         selected_line.product_uom_qty
                     ),
                 )
             selected_line.result_package_id = package
+            if self.work.menu.auto_post_line:
+                # If option auto_post_line is active in the shopfloor menu,
+                # create a split order with this line.
+                self._auto_post_line(selected_line)
             return self._response_for_set_destination(picking, selected_line)
         return self._response_for_set_quantity(
             picking, selected_line, message=self.msg_store.barcode_not_found()
         )
 
     def process_with_existing_pack(self, picking_id, selected_line_id, quantity):
         picking = self.env["stock.picking"].browse(picking_id)
@@ -966,15 +985,15 @@
                 message=self.msg_store.unable_to_pick_more(
                     selected_line.product_uom_qty
                 ),
             )
         selected_line.qty_done = quantity
         return self._response_for_set_destination(picking, selected_line)
 
-    def _auto_post_line(self, selected_line, picking):
+    def _auto_post_line(self, selected_line):
         new_move = selected_line.move_id.split_other_move_lines(
             selected_line, intersection=True
         )
         new_move.extract_and_action_done()
 
     def set_destination(
         self, picking_id, selected_line_id, location_name, confirmation=False
@@ -1033,15 +1052,15 @@
                     ),
                 )
             selected_line.location_dest_id = location
 
         if self.work.menu.auto_post_line:
             # If option auto_post_line is active in the shopfloor menu,
             # create a split order with this line.
-            self._auto_post_line(selected_line, picking)
+            self._auto_post_line(selected_line)
         return self._response_for_select_move(picking)
 
     def select_dest_package(
         self, picking_id, selected_line_id, barcode, confirmation=False
     ):
         """Select the destination package for the move line
 
@@ -1078,15 +1097,15 @@
                     selected_line,
                     message=self.msg_store.package_not_empty(package),
                 )
             selected_line.result_package_id = package
             if self.work.menu.auto_post_line:
                 # If option auto_post_line is active in the shopfloor menu,
                 # create a split order with this line.
-                self._auto_post_line(selected_line, picking)
+                self._auto_post_line(selected_line)
             return self._response_for_select_move(picking)
         message = self.msg_store.create_new_pack_ask_confirmation(barcode)
         self._assign_user_to_picking(picking)
         return self._response_for_confirm_new_package(
             picking, selected_line, new_package_name=barcode, message=message
         )
 
@@ -1336,14 +1355,19 @@
     def _schema_set_quantity(self):
         return {
             "selected_move_line": {
                 "type": "list",
                 "schema": {"type": "dict", "schema": self.schemas.move_line()},
             },
             "picking": {"type": "dict", "schema": self.schemas.picking()},
+            "confirmation_required": {
+                "type": "boolean",
+                "nullable": True,
+                "required": False,
+            },
         }
 
     @property
     def _schema_set_destination(self):
         return {
             "selected_move_line": {
                 "type": "list",
```

## odoo/addons/shopfloor_reception/tests/test_select_document.py

```diff
@@ -91,73 +91,14 @@
         )
         self.assert_response(
             response,
             next_state="select_move",
             data={"picking": self._data_for_picking_with_moves(picking)},
         )
 
-    def test_scan_packaging_single_picking(self):
-        # next step is set_lot
-        picking = self._create_picking()
-        self._add_package(picking)
-        response = self.service.dispatch(
-            "scan_document", params={"barcode": self.product_a_packaging.barcode}
-        )
-        data = self.data.picking(picking)
-        selected_move_line = picking.move_line_ids.filtered(
-            lambda l: l.product_id == self.product_a
-        )
-        self.assert_response(
-            response,
-            next_state="set_lot",
-            data={
-                "picking": data,
-                "selected_move_line": self.data.move_lines(selected_move_line),
-            },
-        )
-
-    def test_scan_product_single_picking(self):
-        # next_step is set_lot
-        picking = self._create_picking()
-        response = self.service.dispatch(
-            "scan_document", params={"barcode": self.product_a.barcode}
-        )
-        data = self.data.picking(picking)
-        selected_move_line = picking.move_line_ids.filtered(
-            lambda l: l.product_id == self.product_a
-        )
-        self.assert_response(
-            response,
-            next_state="set_lot",
-            data={
-                "picking": data,
-                "selected_move_line": self.data.move_lines(selected_move_line),
-            },
-        )
-
-    def test_scan_not_tracked_product_single_picking(self):
-        # next_step is set_quantity
-        self.product_a.tracking = "none"
-        picking = self._create_picking()
-        response = self.service.dispatch(
-            "scan_document", params={"barcode": self.product_a.barcode}
-        )
-        data = self.data.picking(picking)
-        selected_move_line = picking.move_line_ids.filtered(
-            lambda l: l.product_id == self.product_a
-        )
-        self.assert_response(
-            response,
-            next_state="set_quantity",
-            data={
-                "picking": data,
-                "selected_move_line": self.data.move_lines(selected_move_line),
-            },
-        )
-
     def test_scan_packaging_multiple_pickings(self):
         # next step is select_document, with documents filtered based on the product
         p1 = self._create_picking()
         p2 = self._create_picking()
         self._add_package(p1)
         self._add_package(p2)
         response = self.service.dispatch(
@@ -189,29 +130,29 @@
     def test_scan_product_no_picking(self):
         # next_step is select_document, with an error message
         picking = self._create_picking()
         picking.write({"scheduled_date": fields.Datetime.today()})
         response = self.service.dispatch(
             "scan_document", params={"barcode": self.product_c.barcode}
         )
-        body = "No product found among current transfers."
+        body = "Barcode not found"
         self.assert_response(
             response,
             next_state="select_document",
             data={"pickings": self._data_for_pickings(picking)},
-            message={"message_type": "warning", "body": body},
+            message={"message_type": "error", "body": body},
         )
 
     def test_scan_packaging_no_picking(self):
         # next step is select_document, with an error message
         picking = self._create_picking()
         picking.write({"scheduled_date": fields.Datetime.today()})
         response = self.service.dispatch(
             "scan_document", params={"barcode": self.product_c_packaging.barcode}
         )
-        body = "No transfer found for the scanned packaging."
+        body = "Barcode not found"
         self.assert_response(
             response,
             next_state="select_document",
             data={"pickings": self._data_for_pickings(picking)},
             message={"message_type": "error", "body": body},
         )
```

## odoo/addons/shopfloor_reception/tests/test_select_move.py

```diff
@@ -85,14 +85,15 @@
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
         )
 
     def test_scan_not_tracked_product(self):
         self.product_a.tracking = "none"
         picking = self._create_picking()
         self._add_package(picking)
@@ -109,14 +110,15 @@
         )
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
         )
 
     def test_scan_not_tracked_packaging(self):
         self.product_a.tracking = "none"
         picking = self._create_picking()
         self._add_package(picking)
@@ -133,14 +135,15 @@
         )
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
         )
 
     def test_scan_product_not_found(self):
         picking = self._create_picking()
         self._add_package(picking)
         response = self.service.dispatch(
```

## odoo/addons/shopfloor_reception/tests/test_set_destination.py

```diff
@@ -5,96 +5,88 @@
 
 
 class TestSetDestination(CommonCase):
     @classmethod
     def setUpClassBaseData(cls):
         super().setUpClassBaseData()
         cls.packing_location.sudo().active = True
-        cls.parent_location_dest = cls.env.ref("stock.stock_location_stock")
-        cls.location_dest = cls.shelf2
-        cls.another_location = cls.env["stock.location"].search(
-            [("parent_path", "not ilike", cls.parent_location_dest.parent_path)],
-            limit=1,
-        )
+        cls.location_dest = cls.env.ref("stock.stock_location_stock")
 
     @classmethod
     def _change_line_dest(cls, line):
         # Modify the location dest on the move, so we have different children
         # for move's dest_location and pick type's dest_location
         line.location_dest_id = cls.location_dest
 
     def test_scan_location_child_of_dest_location(self):
         picking = self._create_picking()
-        picking.sudo().picking_type_id.default_location_dest_id = self.another_location
         selected_move_line = picking.move_line_ids.filtered(
             lambda l: l.product_id == self.product_a
         )
         self._change_line_dest(selected_move_line)
         response = self.service.dispatch(
             "set_destination",
             params={
                 "picking_id": picking.id,
                 "selected_line_id": selected_move_line.id,
-                "location_name": self.parent_location_dest.name,
+                "location_name": self.shelf2.name,
             },
         )
-        self.assertEqual(selected_move_line.location_dest_id, self.parent_location_dest)
+        self.assertEqual(selected_move_line.location_dest_id, self.shelf2)
         data = self.data.picking(picking, with_progress=True)
         data.update({"moves": self.data.moves(picking.move_lines)})
         self.assert_response(
             response,
             next_state="select_move",
             data={"picking": data},
         )
 
     def test_scan_location_child_of_pick_type_dest_location(self):
         picking = self._create_picking()
-        picking.sudo().picking_type_id.default_location_dest_id = self.shelf2
         selected_move_line = picking.move_line_ids.filtered(
             lambda l: l.product_id == self.product_a
         )
-        selected_move_line.location_dest_id = self.another_location
+        self._change_line_dest(selected_move_line)
         response = self.service.dispatch(
             "set_destination",
             params={
                 "picking_id": picking.id,
                 "selected_line_id": selected_move_line.id,
-                "location_name": self.parent_location_dest.name,
+                "location_name": self.dispatch_location.name,
             },
         )
+
         # location is a child of the picking type's location. destination location
         # hasn't been set
-        self.assertNotEqual(
-            selected_move_line.location_dest_id, self.parent_location_dest
-        )
+        self.assertNotEqual(selected_move_line.location_dest_id, self.dispatch_location)
         # But a confirmation has been asked
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_destination",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
             },
             message={
                 "message_type": "warning",
-                "body": f"Place it in {self.parent_location_dest.name}?",
+                "body": f"Place it in {self.dispatch_location.name}?",
             },
         )
         # Send the same message with confirmation=True to confirm
         response = self.service.dispatch(
             "set_destination",
             params={
                 "picking_id": picking.id,
                 "selected_line_id": selected_move_line.id,
-                "location_name": self.parent_location_dest.name,
+                "location_name": self.dispatch_location.name,
                 "confirmation": True,
             },
         )
-        self.assertEqual(selected_move_line.location_dest_id, self.parent_location_dest)
+        self.assertEqual(selected_move_line.location_dest_id, self.dispatch_location)
         data = self.data.picking(picking, with_progress=True)
         data.update({"moves": self.data.moves(picking.move_lines)})
         self.assert_response(
             response,
             next_state="select_move",
             data={"picking": data},
         )
@@ -125,15 +117,14 @@
 
     def test_auto_posting(self):
         self.menu.sudo().auto_post_line = True
         picking = self._create_picking()
         selected_move_line = picking.move_line_ids.filtered(
             lambda l: l.product_id == self.product_a
         )
-        self._change_line_dest(selected_move_line)
 
         # User has previously scanned a total of 3 units (with 7 still to do).
         # A new pack has been created and assigned to the line.
         self.service.dispatch(
             "process_with_new_pack",
             params={
                 "picking_id": picking.id,
@@ -147,15 +138,15 @@
         # a line with 3 demand will be automatically extracted
         # in a new picking, which will be marked as done.
         self.service.dispatch(
             "set_destination",
             params={
                 "picking_id": picking.id,
                 "selected_line_id": selected_move_line.id,
-                "location_name": self.parent_location_dest.name,
+                "location_name": self.dispatch_location.name,
             },
         )
         # The line has been moved to a different picking.
         self.assertNotEqual(picking, selected_move_line.picking_id)
         # Its qty_done is 3.
         self.assertEqual(selected_move_line.qty_done, 3)
         # The new picking is marked as done.
```

## odoo/addons/shopfloor_reception/tests/test_set_lot_confirm.py

```diff
@@ -57,9 +57,10 @@
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
         )
```

## odoo/addons/shopfloor_reception/tests/test_set_quantity.py

```diff
@@ -7,16 +7,14 @@
 class TestSetQuantity(CommonCase):
     @classmethod
     def setUpClassBaseData(cls):
         super().setUpClassBaseData()
         cls.product_a_packaging.qty = 5.0
         cls.packing_location.sudo().active = True
         package_model = cls.env["stock.quant.package"]
-        cls.parent_location_dest = cls.env.ref("stock.stock_location_stock")
-        cls.location_dest = cls.shelf2
         cls.package_without_location = package_model.create(
             {
                 "name": "PKG_WO_LOCATION",
                 "packaging_id": cls.product_a_packaging.id,
             }
         )
         cls.package_with_location = package_model.create(
@@ -27,20 +25,19 @@
         )
         cls.package_with_location_child_of_dest = package_model.create(
             {
                 "name": "PKG_W_LOCATION_CHILD",
                 "packaging_id": cls.product_a_packaging.id,
             }
         )
-        cls.package_with_location_child_of_dest.location_id = cls.location_dest
         cls._update_qty_in_location(
             cls.packing_location, cls.product_a, 10, package=cls.package_with_location
         )
         cls._update_qty_in_location(
-            cls.parent_location_dest,
+            cls.dispatch_location,
             cls.product_a,
             10,
             package=cls.package_with_location_child_of_dest,
         )
 
     def test_set_quantity_scan_product(self):
         picking = self._create_picking()
@@ -61,14 +58,15 @@
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
         )
 
     def test_set_quantity_scan_packaging(self):
         picking = self._create_picking()
         selected_move_line = picking.move_line_ids.filtered(
             lambda l: l.product_id == self.product_a
@@ -87,14 +85,15 @@
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
         )
 
     def test_scan_product(self):
         picking = self._create_picking()
         selected_move_line = picking.move_line_ids.filtered(
             lambda l: l.product_id == self.product_a
@@ -112,14 +111,15 @@
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
         )
         # Scan again, and ensure qty increments
         self.service.dispatch(
             "set_quantity",
             params={
                 "picking_id": picking.id,
@@ -163,14 +163,15 @@
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
         )
         # Scan again, and ensure qty increments
         self.service.dispatch(
             "set_quantity",
             params={
                 "picking_id": picking.id,
@@ -182,29 +183,28 @@
 
     def test_scan_package_with_destination_child_of_dest_location(self):
         # next step is select_move
         picking = self._create_picking()
         selected_move_line = picking.move_line_ids.filtered(
             lambda l: l.product_id == self.product_a
         )
-        selected_move_line.location_dest_id = self.parent_location_dest
         selected_move_line.shopfloor_user_id = self.env.uid
         response = self.service.dispatch(
             "set_quantity",
             params={
                 "picking_id": picking.id,
                 "selected_line_id": selected_move_line.id,
                 "barcode": self.package_with_location_child_of_dest.name,
             },
         )
         self.assertEqual(
             selected_move_line.result_package_id,
             self.package_with_location_child_of_dest,
         )
-        self.assertEqual(selected_move_line.location_dest_id, self.parent_location_dest)
+        self.assertEqual(selected_move_line.location_dest_id, self.dispatch_location)
         data = self.data.picking(picking, with_progress=True)
         data.update({"moves": self.data.moves(picking.move_lines)})
         self.assert_response(response, next_state="select_move", data={"picking": data})
 
     def test_scan_package_with_destination_not_child_of_dest_location(self):
         # next step is set_quantity with error
         picking = self._create_picking()
@@ -223,14 +223,15 @@
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
             message={"message_type": "error", "body": "You cannot place it here"},
         )
 
     def test_scan_package_without_location(self):
         # next_step is set_destination
         picking = self._create_picking()
@@ -260,25 +261,24 @@
         )
 
     def test_scan_location_child_of_dest_location(self):
         picking = self._create_picking()
         selected_move_line = picking.move_line_ids.filtered(
             lambda l: l.product_id == self.product_a
         )
-        selected_move_line.location_dest_id = self.location_dest
         selected_move_line.shopfloor_user_id = self.env.uid
         response = self.service.dispatch(
             "set_quantity",
             params={
                 "picking_id": picking.id,
                 "selected_line_id": selected_move_line.id,
-                "barcode": self.parent_location_dest.barcode,
+                "barcode": self.dispatch_location.barcode,
             },
         )
-        self.assertEqual(selected_move_line.location_dest_id, self.parent_location_dest)
+        self.assertEqual(selected_move_line.location_dest_id, self.dispatch_location)
         data = self.data.picking(picking, with_progress=True)
         data.update({"moves": self.data.moves(picking.move_lines)})
         self.assert_response(response, next_state="select_move", data={"picking": data})
 
     def test_scan_location_not_child_of_dest_location(self):
         picking = self._create_picking()
         selected_move_line = picking.move_line_ids.filtered(
@@ -296,14 +296,15 @@
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
             message={"message_type": "error", "body": "You cannot place it here"},
         )
 
     def test_scan_location_view_usage(self):
         picking = self._create_picking()
         selected_move_line = picking.move_line_ids.filtered(
@@ -323,14 +324,15 @@
         data = self.data.picking(picking)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": False,
             },
             message={"message_type": "error", "body": "You cannot place it here"},
         )
 
     def test_scan_new_package(self):
         picking = self._create_picking()
         selected_move_line = picking.move_line_ids.filtered(
@@ -349,14 +351,15 @@
         self.assertFalse(selected_move_line.result_package_id)
         self.assert_response(
             response,
             next_state="set_quantity",
             data={
                 "picking": picking_data,
                 "selected_move_line": self.data.move_lines(selected_move_line),
+                "confirmation_required": True,
             },
             message={
                 "message_type": "warning",
                 "body": "Create new PACK FooBar? Scan it again to confirm.",
             },
         )
         response = self.service.dispatch(
```

## Comparing `odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/METADATA` & `odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-shopfloor-reception
-Version: 14.0.1.2.0
+Version: 14.0.1.3.0
 Summary: Reception scenario for shopfloor
 Home-page: https://github.com/OCA/wms
 Author: Camptocamp, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/RECORD` & `odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/RECORD`

 * *Files 7% similar despite different names*

```diff
@@ -1,33 +1,33 @@
 odoo/addons/shopfloor_reception/README.rst,sha256=Tnpc_JsUSx9BfFo1IeKugKcvXhlMwt2Xb3QNxI58nuY,3384
 odoo/addons/shopfloor_reception/__init__.py,sha256=qksdRxAxHhEXpY0NZlTEolhxFILjRI5o7J0O4UrAE04,23
-odoo/addons/shopfloor_reception/__manifest__.py,sha256=nzi_khX1P-yWpT5zRnKqGxD14uL-uV4WvV7VXrtvLVw,587
+odoo/addons/shopfloor_reception/__manifest__.py,sha256=oMcofECBKkldXC0xGi22CxBLf3E1TPLRhEeM8IPwe3E,587
 odoo/addons/shopfloor_reception/data/shopfloor_scenario_data.xml,sha256=DSrWXaqkXwEIcw6YrkYYsZihjwnA9Ah2O37syYn8gz8,412
 odoo/addons/shopfloor_reception/demo/shopfloor_menu_demo.xml,sha256=gNiAE7qk8vWaV2wnol52hOo1fFOM_9mxUyl3vKESspw,627
 odoo/addons/shopfloor_reception/demo/stock_picking_type_demo.xml,sha256=bsT91Ie8Sq1tzRyDlxqRTa3HoNlqRdDQyPLwYHVkDuE,965
 odoo/addons/shopfloor_reception/docs/reception_sequence_graph.mermaid,sha256=RtF-q5XBm9-Bw27MQXt-12oS4bdmTW6FSgyYbr4YXV0,3866
 odoo/addons/shopfloor_reception/docs/reception_sequence_graph.png,sha256=H41YZ5izgSD5CBxoDv51ypNGeWrOlwA7sXNH2NH1guM,155103
 odoo/addons/shopfloor_reception/i18n/shopfloor_reception.pot,sha256=rqeyaznriN_9zTy86npNrr2f87SJsRDQDHa1bjEU37M,658
 odoo/addons/shopfloor_reception/readme/CONTRIBUTORS.rst,sha256=T0hVdBlkQoY1jSU4_VeTBpXUfsII9PSBrSh7jtmOe2Y,216
 odoo/addons/shopfloor_reception/readme/DESCRIPTION.rst,sha256=WgVul7wqGircZzFGHZlHdf7uQwGDNYADf9HXF96ngow,131
 odoo/addons/shopfloor_reception/readme/ROADMAP.rst,sha256=-oVCQbD8gOlGbREemrJISQ785Mhf3_KDv4b26EKl0lw,109
 odoo/addons/shopfloor_reception/services/__init__.py,sha256=KwBANbkfhp2yAZYBiuBKYL2G7ky7sCaE-0yO4b-0mgs,24
-odoo/addons/shopfloor_reception/services/reception.py,sha256=LfBXcHDWgyjDdYjw9iP5Zwk3TI3SaWaA1hkJ7xxSy48,57237
+odoo/addons/shopfloor_reception/services/reception.py,sha256=1XT3tkYLEahKc3e2NEtPXhXLdPKtAEYBMseqTV4egzo,58269
 odoo/addons/shopfloor_reception/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/shopfloor_reception/static/description/index.html,sha256=a5J-vJ6aIA2frc-pJnrak7YlbPL4ksEXYOePLA1-tWg,12973
 odoo/addons/shopfloor_reception/tests/__init__.py,sha256=WHT---1-luQV6ExwBdDJjWJwBqUu1sk9AP-VFP5aOV8,368
 odoo/addons/shopfloor_reception/tests/common.py,sha256=kmYpDg2xERfIR-nujEtnxcCWiKXA9MI7gYNKpNn5qx8,4729
 odoo/addons/shopfloor_reception/tests/test_manual_selection.py,sha256=jUWqAyWcGsoFTLeLLOk0mTadZk-mlR1RBbl4fasUoWI,1253
 odoo/addons/shopfloor_reception/tests/test_reception_done.py,sha256=9dqn3WUmaPwjwcvnT8eXj7Mi_96kQP1ZaY1m8fmSAgc,3450
 odoo/addons/shopfloor_reception/tests/test_select_dest_package.py,sha256=SQd5tmp_swFjLfwJ5npKR8W1sFQW6es5KltErY1tMY0,4836
-odoo/addons/shopfloor_reception/tests/test_select_document.py,sha256=uh3tYMWoC5VXDwkOPwEuwlEFr5FlAhRkFUlWwXdmbOY,8223
-odoo/addons/shopfloor_reception/tests/test_select_move.py,sha256=3O2Olgs6XhJcEYh5K4r-SEOTKNW_oMvOsjEd7BpQMAs,10654
-odoo/addons/shopfloor_reception/tests/test_set_destination.py,sha256=mwR8nDHAkRNuq26GEXAvxryLa5LKEa4Jk2zfJNzarb4,6804
+odoo/addons/shopfloor_reception/tests/test_select_document.py,sha256=Zj79icOvQLAv1WLP3hYlVoIlP3RjuRnzu58hBeljgPE,6098
+odoo/addons/shopfloor_reception/tests/test_select_move.py,sha256=u1iR25Emn-CiCjqdLe2SrbLAfV5CJNBja6MDR0c3mfM,10798
+odoo/addons/shopfloor_reception/tests/test_set_destination.py,sha256=_YM3HRnT0zti6VwlN-Mhg8hPRYn3cGB7FdMpDQrrggQ,6279
 odoo/addons/shopfloor_reception/tests/test_set_lot.py,sha256=JtEMOcBNYAYmj1KIL9C2Zs4dBJWM7dbwadO3iRi5bOo,5574
-odoo/addons/shopfloor_reception/tests/test_set_lot_confirm.py,sha256=sZyyo3dileCY5kJ8Bg6ru7gErWZyTTYSvSRlc9sooMU,2219
-odoo/addons/shopfloor_reception/tests/test_set_quantity.py,sha256=Tga-dEFeU3GZcqP2tSx7xO3zgu9ZVVmkf4aqo7SowLo,14216
+odoo/addons/shopfloor_reception/tests/test_set_lot_confirm.py,sha256=LfC8ct247by9V2Df3THnE_VT4dT0KMYrWGn28JM2lR8,2267
+odoo/addons/shopfloor_reception/tests/test_set_quantity.py,sha256=d-iAbgK32cd_WBjboVEMooK3yI80rfycOJ6LzSligBg,14254
 odoo/addons/shopfloor_reception/tests/test_set_quantity_action.py,sha256=Q1AjYwAJT-lVjYPOOi0P-9cyes0wfniSiH0R3lGgvQU,2914
 odoo/addons/shopfloor_reception/tests/test_start.py,sha256=Df9ezNG7BqJQ6PtNY4-LvH1SyFZdpyF4LjV1PhpsCqY,1699
-odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/METADATA,sha256=rc2Y3XbK6JhY-Tglq6QKNF12nlgjk2m06Tp4QZbb-CQ,4006
-odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_shopfloor_reception-14.0.1.2.0.dist-info/RECORD,,
+odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/METADATA,sha256=o2D6Il_n66H1NUmaDydO9KxbDlEwrHKoA4L4ZePHOHM,4006
+odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_shopfloor_reception-14.0.1.3.0.dist-info/RECORD,,
```

